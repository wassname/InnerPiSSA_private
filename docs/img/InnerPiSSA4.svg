<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 800" width="900" height="800">
<defs>
  <!-- Arrow markers -->
  <marker id="arrowGray" markerWidth="8" markerHeight="8" 
          refX="7" refY="3" orient="auto" markerUnits="strokeWidth">
    <path d="M0,0 L0,6 L7,3 z" fill="#888"/>
  </marker>
  <marker id="arrowOrange" markerWidth="10" markerHeight="10" 
          refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
    <path d="M0,0 L0,6 L9,3 z" fill="#D97706"/>
  </marker>
  <marker id="arrowRed" markerWidth="10" markerHeight="10" 
          refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
    <path d="M0,0 L0,6 L9,3 z" fill="#DC2626"/>
  </marker>
  
  <!-- Subtle radial gradient -->
  <radialGradient id="bgGradient" cx="50%" cy="50%" r="50%">
    <stop offset="0%" style="stop-color:#FFF9E6;stop-opacity:0.2" />
    <stop offset="100%" style="stop-color:#FFE8B3;stop-opacity:0.05" />
  </radialGradient>
</defs>

<!-- Background -->
<rect x="0" y="0" width="900" height="800" fill="#ffffff"/>
<circle cx="450" cy="400" r="250" fill="url(#bgGradient)"/>

<!-- Coherence boundary -->
<circle cx="450" cy="400" r="250" 
        stroke="#8B6F47" 
        stroke-width="4" 
        fill="none" 
        stroke-dasharray="10 8"
        opacity="0.7"/>

<!-- Sample 1: upper-left region -->
<g id="sample1">
  <!-- Reference separation (gray) -->
  <line x1="300" y1="300" x2="250" y2="220" 
        stroke="#888" 
        stroke-width="3" 
        opacity="0.6"
        marker-end="url(#arrowGray)"/>
  <!-- Policy separation c=+1 (orange) - aligned with ref -->
  <line x1="300" y1="300" x2="240" y2="200" 
        stroke="#D97706" 
        stroke-width="3.5" 
        marker-end="url(#arrowOrange)"/>
  <!-- Alignment indicator (short dotted line) -->
  <line x1="240" y1="200" x2="250" y2="220" 
        stroke="#D97706" 
        stroke-width="1.5" 
        stroke-dasharray="3 3" 
        opacity="0.5"/>
  <text x="230" y="195" 
        font-family="Georgia, Garamond, serif" 
        font-size="11" 
        fill="#666">sample A</text>
</g>

<!-- Sample 2: left region -->
<g id="sample2">
  <line x1="300" y1="400" x2="220" y2="380" 
        stroke="#888" 
        stroke-width="3" 
        opacity="0.6"
        marker-end="url(#arrowGray)"/>
  <line x1="300" y1="400" x2="210" y2="375" 
        stroke="#D97706" 
        stroke-width="3.5" 
        marker-end="url(#arrowOrange)"/>
  <line x1="210" y1="375" x2="220" y2="380" 
        stroke="#D97706" 
        stroke-width="1.5" 
        stroke-dasharray="3 3" 
        opacity="0.5"/>
  <text x="200" y="370" 
        font-family="Georgia, Garamond, serif" 
        font-size="11" 
        fill="#666">sample B</text>
</g>

<!-- Sample 3: upper-right region (different quadrant!) -->
<g id="sample3">
  <line x1="550" y1="320" x2="620" y2="260" 
        stroke="#888" 
        stroke-width="3" 
        opacity="0.6"
        marker-end="url(#arrowGray)"/>
  <line x1="550" y1="320" x2="630" y2="250" 
        stroke="#D97706" 
        stroke-width="3.5" 
        marker-end="url(#arrowOrange)"/>
  <line x1="630" y1="250" x2="620" y2="260" 
        stroke="#D97706" 
        stroke-width="1.5" 
        stroke-dasharray="3 3" 
        opacity="0.5"/>
  <text x="635" y="245" 
        font-family="Georgia, Garamond, serif" 
        font-size="11" 
        fill="#666">sample C</text>
</g>

<!-- Sample 4: lower region with c=-1 -->
<g id="sample4">
  <line x1="400" y1="520" x2="380" y2="600" 
        stroke="#888" 
        stroke-width="3" 
        opacity="0.6"
        marker-end="url(#arrowGray)"/>
  <!-- Policy with c=-1 (red) - opposite direction -->
  <line x1="400" y1="520" x2="420" y2="440" 
        stroke="#DC2626" 
        stroke-width="3.5" 
        marker-end="url(#arrowRed)"/>
  <line x1="420" y1="440" x2="380" y2="600" 
        stroke="#DC2626" 
        stroke-width="1.5" 
        stroke-dasharray="3 3" 
        opacity="0.5"/>
  <text x="425" y="435" 
        font-family="Georgia, Garamond, serif" 
        font-size="11" 
        fill="#666">sample D (c=-1)</text>
</g>

<!-- Title -->
<text x="450" y="35" 
      font-family="Georgia, Garamond, serif" 
      font-size="24" 
      font-weight="600"
      fill="#1a1a1a" 
      text-anchor="middle">InnerPiSSA: Per-Sample Alignment</text>
<text x="450" y="58" 
      font-family="Georgia, Garamond, serif" 
      font-size="14" 
      fill="#666" 
      text-anchor="middle"
      font-style="italic">in PiSSA space (SVD basis of layer weights)</text>

<!-- Labels -->
<g>
  <!-- Boundary label -->
  <text x="450" y="120" 
        font-family="Georgia, Garamond, serif" 
        font-size="15" 
        fill="#8B6F47" 
        text-anchor="middle"
        font-style="italic">Coherence boundary</text>
  
  <!-- Inner/Outer -->
  <text x="680" y="395" 
        font-family="Georgia, Garamond, serif" 
        font-size="13" 
        fill="#8B6F47" 
        text-anchor="start"
        opacity="0.7">Inner</text>
  <text x="715" y="395" 
        font-family="Georgia, Garamond, serif" 
        font-size="13" 
        fill="#999" 
        text-anchor="start"
        opacity="0.6">| Outer</text>
</g>

<!-- Legend -->
<g transform="translate(20, 680)">
  <text x="0" y="0" 
        font-family="Georgia, Garamond, serif" 
        font-size="16" 
        font-weight="600"
        fill="#1a1a1a">Per-Sample Geometry</text>
  
  <g transform="translate(0, 25)">
    <line x1="0" y1="0" x2="30" y2="0" stroke="#888" stroke-width="3" marker-end="url(#arrowGray)"/>
    <text x="40" y="5" 
          font-family="Georgia, Garamond, serif" 
          font-size="13" 
          fill="#2a2a2a">
      <tspan font-weight="600" fill="#888">Gray arrows</tspan>: Reference model separation (h_ref_cho − h_ref_rej) for each sample
    </text>
  </g>
  
  <g transform="translate(0, 45)">
    <line x1="0" y1="0" x2="30" y2="0" stroke="#D97706" stroke-width="3.5" marker-end="url(#arrowOrange)"/>
    <text x="40" y="5" 
          font-family="Georgia, Garamond, serif" 
          font-size="13" 
          fill="#2a2a2a">
      <tspan font-weight="600" fill="#D97706">Orange arrows (c=+1)</tspan>: Policy model separation after learned transformation
    </text>
  </g>
  
  <g transform="translate(0, 65)">
    <line x1="0" y1="0" x2="30" y2="0" stroke="#DC2626" stroke-width="3.5" marker-end="url(#arrowRed)"/>
    <text x="40" y="5" 
          font-family="Georgia, Garamond, serif" 
          font-size="13" 
          fill="#2a2a2a">
      <tspan font-weight="600" fill="#DC2626">Red arrows (c=−1)</tspan>: Same transformation reversed (coefficient sign flip)
    </text>
  </g>
  
  <g transform="translate(0, 85)">
    <line x1="0" y1="0" x2="20" y2="0" stroke="#D97706" stroke-width="1.5" stroke-dasharray="3 3"/>
    <text x="30" y="5" 
          font-family="Georgia, Garamond, serif" 
          font-size="13" 
          fill="#2a2a2a">
      <tspan font-weight="600">Dotted lines</tspan>: Alignment quality (short = good alignment)
    </text>
  </g>
  
  <text x="0" y="110" 
        font-family="Georgia, Garamond, serif" 
        font-size="13" 
        fill="#1a1a1a"
        font-weight="600">Loss per sample:</text>
  <text x="130" y="110" 
        font-family="Georgia, Garamond, serif" 
        font-size="13" 
        fill="#4A5568"
        font-style="italic">maximize (orange · gray) subject to coherence</text>
</g>

<!-- Origin -->
<circle cx="450" cy="400" r="3" fill="#1a1a1a"/>

</svg>
