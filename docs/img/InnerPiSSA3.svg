<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 800" width="900" height="800">
<defs>
  <!-- Radial gradient for subtle warmth -->
  <radialGradient id="pizzaGradient" cx="50%" cy="50%" r="50%">
    <stop offset="0%" style="stop-color:#FFF9E6;stop-opacity:0.3" />
    <stop offset="70%" style="stop-color:#FFE8B3;stop-opacity:0.2" />
    <stop offset="100%" style="stop-color:#D4A574;stop-opacity:0.1" />
  </radialGradient>
  
  <!-- Arrow markers -->
  <marker id="arrowBlue" markerWidth="10" markerHeight="10" 
          refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
    <path d="M0,0 L0,6 L9,3 z" fill="#2E5C8A"/>
  </marker>
  <marker id="arrowOrange" markerWidth="10" markerHeight="10" 
          refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
    <path d="M0,0 L0,6 L9,3 z" fill="#D97706"/>
  </marker>
  <marker id="arrowRed" markerWidth="10" markerHeight="10" 
          refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
    <path d="M0,0 L0,6 L9,3 z" fill="#DC2626"/>
  </marker>
  <marker id="arrowGray" markerWidth="8" markerHeight="8" 
          refX="7" refY="3" orient="auto" markerUnits="strokeWidth">
    <path d="M0,0 L0,6 L7,3 z" fill="#999"/>
  </marker>
</defs>

<!-- White background -->
<rect x="0" y="0" width="900" height="800" fill="#ffffff"/>

<!-- InnerPiSSA space with subtle gradient fill -->
<circle cx="410" cy="350" r="200" fill="url(#pizzaGradient)"/>

<!-- Coherence boundary - brown dashed circle -->
<circle cx="410" cy="350" r="200" 
        stroke="#8B6F47" 
        stroke-width="5" 
        fill="none" 
        stroke-dasharray="10 8"
        opacity="0.85"/>

<!-- Per-sample reference directions (gray, varied angles showing dataset diversity) -->
<!-- Sample A: upper-left (steep) -->
<line x1="410" y1="350" x2="310" y2="210" 
      stroke="#999" 
      stroke-width="2.5" 
      opacity="0.5"
      marker-end="url(#arrowGray)"/>

<!-- Sample B: left (moderate) -->
<line x1="410" y1="350" x2="260" y2="300" 
      stroke="#999" 
      stroke-width="2.5" 
      opacity="0.5"
      marker-end="url(#arrowGray)"/>

<!-- Sample C: upper-right (different quadrant!) -->
<line x1="410" y1="350" x2="530" y2="230" 
      stroke="#999" 
      stroke-width="2.5" 
      opacity="0.5"
      marker-end="url(#arrowGray)"/>

<!-- Sample D: lower-left -->
<line x1="410" y1="350" x2="320" y2="460" 
      stroke="#999" 
      stroke-width="2.5" 
      opacity="0.5"
      marker-end="url(#arrowGray)"/>

<!-- Label for sample diversity -->
<text x="260" y="295" 
      font-family="Georgia, Garamond, serif" 
      font-size="11" 
      fill="#999"
      opacity="0.7">samples vary</text>

<!-- Learned transformation (bold) - must work across all samples -->
<!-- c=+1 (honest) - compromise direction -->
<line x1="410" y1="350" x2="340" y2="240" 
      stroke="#D97706" 
      stroke-width="5" 
      marker-end="url(#arrowOrange)"/>

<!-- c=-1 (dishonest) - opposite -->
<line x1="410" y1="350" x2="480" y2="460" 
      stroke="#DC2626" 
      stroke-width="5" 
      marker-end="url(#arrowRed)"/>

<!-- Projection lines: show learned direction projects differently onto each sample -->
<line x1="340" y1="240" x2="310" y2="210" 
      stroke="#D97706" 
      stroke-width="2" 
      stroke-dasharray="4 4" 
      opacity="0.6"/>
<line x1="340" y1="240" x2="260" y2="300" 
      stroke="#D97706" 
      stroke-width="2" 
      stroke-dasharray="4 4" 
      opacity="0.6"/>
<line x1="340" y1="240" x2="530" y2="230" 
      stroke="#D97706" 
      stroke-width="2" 
      stroke-dasharray="4 4" 
      opacity="0.6"/>

<!-- Title -->
<text x="450" y="35" 
      font-family="Georgia, Garamond, serif" 
      font-size="24" 
      font-weight="600"
      fill="#1a1a1a" 
      text-anchor="middle">InnerPiSSA Training Geometry</text>
<text x="450" y="58" 
      font-family="Georgia, Garamond, serif" 
      font-size="14" 
      fill="#666" 
      text-anchor="middle"
      font-style="italic">in PiSSA space</text>

<!-- Labels -->
<g>
  <!-- c=+1 label -->
  <text x="250" y="225" 
        font-family="Georgia, Garamond, serif" 
        font-size="16" 
        fill="#D97706" 
        font-weight="600">c = +1</text>
  <text x="250" y="242" 
        font-family="Georgia, Garamond, serif" 
        font-size="13" 
        fill="#4A5568">(compromise)</text>
  
  <!-- c=-1 label -->
  <text x="495" y="475" 
        font-family="Georgia, Garamond, serif" 
        font-size="16" 
        fill="#DC2626" 
        font-weight="600">c = −1</text>
  <text x="495" y="492" 
        font-family="Georgia, Garamond, serif" 
        font-size="13" 
        fill="#4A5568">(reversed)</text>
  
  <!-- Boundary label -->
  <text x="450" y="130" 
        font-family="Georgia, Garamond, serif" 
        font-size="15" 
        fill="#8B6F47" 
        text-anchor="middle"
        font-style="italic">Coherence boundary</text>
  
  <!-- Inner/Outer region labels -->
  <text x="590" y="345" 
        font-family="Georgia, Garamond, serif" 
        font-size="13" 
        fill="#8B6F47" 
        text-anchor="start"
        opacity="0.7">Inner</text>
  <text x="625" y="345" 
        font-family="Georgia, Garamond, serif" 
        font-size="13" 
        fill="#999" 
        text-anchor="start"
        opacity="0.6">| Outer</text>
</g>

<!-- Legend/Caption -->
<g transform="translate(20, 580)">
  <text x="0" y="0" 
        font-family="Georgia, Garamond, serif" 
        font-size="16" 
        font-weight="600"
        fill="#1a1a1a">PiSSA Space</text>
  
  <text x="0" y="25" 
        font-family="Georgia, Garamond, serif" 
        font-size="13" 
        fill="#4A5568">2D projection of output singular vector basis from SVD(W) = U·Σ·V</text>
  <text x="0" y="40" 
        font-family="Georgia, Garamond, serif" 
        font-size="13" 
        fill="#4A5568"
        font-style="italic">T</text>
  
  <!-- Bullet points -->
  <g transform="translate(0, 60)">
    <circle cx="5" cy="-3" r="3" fill="#999"/>
    <text x="15" y="0" 
          font-family="Georgia, Garamond, serif" 
          font-size="13" 
          fill="#2a2a2a">
      <tspan font-weight="600" fill="#999">Gray arrows</tspan>: Per-sample reference separations (h_cho − h_rej) vary across dataset
    </text>
  </g>
  
  <g transform="translate(0, 80)">
    <circle cx="5" cy="-3" r="3" fill="#D97706"/>
    <text x="15" y="0" 
          font-family="Georgia, Garamond, serif" 
          font-size="13" 
          fill="#2a2a2a">
      <tspan font-weight="600" fill="#D97706">c = +1</tspan>: Single learned transformation (V rotation + S scaling) amplifies across all samples
    </text>
  </g>
  
  <g transform="translate(0, 100)">
    <circle cx="5" cy="-3" r="3" fill="#DC2626"/>
    <text x="15" y="0" 
          font-family="Georgia, Garamond, serif" 
          font-size="13" 
          fill="#2a2a2a">
      <tspan font-weight="600" fill="#DC2626">c = −1</tspan>: Same transformation suppresses (reversible via coefficient sign)
    </text>
  </g>
  
  <g transform="translate(0, 120)">
    <circle cx="5" cy="-3" r="3" fill="#8B6F47"/>
    <text x="15" y="0" 
          font-family="Georgia, Garamond, serif" 
          font-size="13" 
          fill="#2a2a2a">
      <tspan font-weight="600" fill="#8B6F47">Boundary</tspan>: Maintains coherence (log p<tspan baseline-shift="sub" font-size="10">π</tspan> ≥ log p<tspan baseline-shift="sub" font-size="10">ref</tspan> − τ) for all samples
    </text>
  </g>
  
  <!-- Loss function -->
  <text x="0" y="150" 
        font-family="Georgia, Garamond, serif" 
        font-size="13" 
        fill="#1a1a1a"
        font-weight="600">Loss per sample:</text>
  <text x="130" y="150" 
        font-family="Georgia, Garamond, serif" 
        font-size="13" 
        fill="#4A5568"
        font-style="italic">maximize (h_π_pos − h_π_neg) · (h_ref_cho − h_ref_rej) subject to coherence</text>
  
  <text x="0" y="170" 
        font-family="Georgia, Garamond, serif" 
        font-size="12" 
        fill="#666"
        font-style="italic">V rotation finds compromise transformation that works well across sample distribution</text>
</g>

<!-- Origin point -->
<circle cx="410" cy="350" r="4" fill="#1a1a1a"/>
<text x="420" y="368" 
      font-family="Georgia, Garamond, serif" 
      font-size="12" 
      fill="#4A5568">origin</text>

</svg>
