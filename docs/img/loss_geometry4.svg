<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 600" width="600" height="600">
  <!-- Background -->
  <rect width="600" height="600" fill="#fafafa"/>
  
  <!-- Define arrow markers -->
  <defs>
    <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#2563eb" />
    </marker>
    <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#ea580c" />
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#16a34a" />
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#dc2626" />
    </marker>
  </defs>
  
  <!-- Grid and axes -->
  <g opacity="0.15">
    <line x1="50" y1="550" x2="550" y2="550" stroke="#666" stroke-width="1"/>
    <line x1="50" y1="50" x2="50" y2="550" stroke="#666" stroke-width="1"/>
    <!-- Grid lines -->
    <line x1="150" y1="550" x2="150" y2="50" stroke="#ccc" stroke-width="0.5" stroke-dasharray="2,2"/>
    <line x1="250" y1="550" x2="250" y2="50" stroke="#ccc" stroke-width="0.5" stroke-dasharray="2,2"/>
    <line x1="350" y1="550" x2="350" y2="50" stroke="#ccc" stroke-width="0.5" stroke-dasharray="2,2"/>
    <line x1="450" y1="550" x2="450" y2="50" stroke="#ccc" stroke-width="0.5" stroke-dasharray="2,2"/>
    <line x1="50" y1="450" x2="550" y2="450" stroke="#ccc" stroke-width="0.5" stroke-dasharray="2,2"/>
    <line x1="50" y1="350" x2="550" y2="350" stroke="#ccc" stroke-width="0.5" stroke-dasharray="2,2"/>
    <line x1="50" y1="250" x2="550" y2="250" stroke="#ccc" stroke-width="0.5" stroke-dasharray="2,2"/>
    <line x1="50" y1="150" x2="550" y2="150" stroke="#ccc" stroke-width="0.5" stroke-dasharray="2,2"/>
  </g>
  
  <!-- Axes labels -->
  <text x="520" y="570" font-size="14" fill="#666" font-family="Arial, sans-serif">S₁</text>
  <text x="25" y="70" font-size="14" fill="#666" font-family="Arial, sans-serif">S₂</text>
  
  <!-- Origin point -->
  <circle cx="50" cy="550" r="3" fill="#333"/>
  <text x="30" y="570" font-size="12" fill="#666" font-family="Arial, sans-serif">0</text>
  
  <!-- Coherence boundary (main - solid) -->
  <path d="M 50 250 A 300 300 0 0 1 350 550" 
        fill="none" 
        stroke="#9333ea" 
        stroke-width="2" 
        stroke-dasharray="5,5"
        opacity="0.6"/>
  
  <!-- Relaxed coherence boundary (for hard direction - dashed, larger radius) -->
  <path d="M 50 150 A 400 400 0 0 1 450 550" 
        fill="none" 
        stroke="#9333ea" 
        stroke-width="1.5" 
        stroke-dasharray="8,4"
        opacity="0.3"/>
  
  <!-- Reference direction pref_dir_ref (blue, angle ~30 deg from horizontal) -->
  <line x1="50" y1="550" x2="350" y2="320" 
        stroke="#2563eb" 
        stroke-width="3" 
        marker-end="url(#arrowBlue)"/>
  
  <!-- Initial policy direction pref_dir_pi at t=0 (orange, same as reference) -->
  <line x1="50" y1="550" x2="320" y2="350" 
        stroke="#ea580c" 
        stroke-width="2.5" 
        marker-end="url(#arrowOrange)"
        opacity="0.7"/>
  
  <!-- After training c=+1 (green - rotates toward ref, amplifies) -->
  <!-- Closer angle to blue, longer -->
  <line x1="50" y1="550" x2="380" y2="280" 
        stroke="#16a34a" 
        stroke-width="3" 
        marker-end="url(#arrowGreen)"/>
  
  <!-- After training c=-1 (red - rotates away, shrinks) -->
  <!-- Larger angle from blue, shorter -->
  <line x1="50" y1="550" x2="240" y2="430" 
        stroke="#dc2626" 
        stroke-width="3" 
        marker-end="url(#arrowRed)"/>
  
  <!-- Projection lines (perpendicular to pref_dir_ref) -->
  <!-- For green arrow -->
  <line x1="380" y1="280" x2="320" y2="275" 
        stroke="#16a34a" 
        stroke-width="1" 
        stroke-dasharray="2,2"
        opacity="0.5"/>
  
  <!-- For red arrow -->
  <line x1="240" y1="430" x2="190" y2="460" 
        stroke="#dc2626" 
        stroke-width="1" 
        stroke-dasharray="2,2"
        opacity="0.5"/>
  
  <!-- Projection points on reference line -->
  <circle cx="320" cy="275" r="3" fill="#16a34a" opacity="0.7"/>
  <circle cx="190" cy="460" r="3" fill="#dc2626" opacity="0.7"/>
  
  <!-- Labels -->
  <!-- Reference direction -->
  <text x="360" y="310" font-size="13" fill="#2563eb" font-family="Arial, sans-serif" font-weight="bold">
    pref_dir_ref
  </text>
  <text x="360" y="325" font-size="11" fill="#2563eb" font-family="Arial, sans-serif">
    (frozen target)
  </text>
  
  <!-- Initial policy -->
  <text x="330" y="340" font-size="12" fill="#ea580c" font-family="Arial, sans-serif">
    pref_dir_pi (t=0)
  </text>
  
  <!-- Honest direction (c=+1) -->
  <text x="390" y="265" font-size="13" fill="#16a34a" font-family="Arial, sans-serif" font-weight="bold">
    Honest direction
  </text>
  <text x="390" y="280" font-size="11" fill="#16a34a" font-family="Arial, sans-serif">
    (c=+1: rotates toward,
  </text>
  <text x="390" y="293" font-size="11" fill="#16a34a" font-family="Arial, sans-serif">
    amplifies)
  </text>
  
  <!-- Dishonest direction (c=-1) -->
  <text x="100" y="410" font-size="13" fill="#dc2626" font-family="Arial, sans-serif" font-weight="bold">
    Dishonest direction
  </text>
  <text x="100" y="425" font-size="11" fill="#dc2626" font-family="Arial, sans-serif">
    (c=-1: rotates away,
  </text>
  <text x="100" y="438" font-size="11" fill="#dc2626" font-family="Arial, sans-serif">
    shrinks)
  </text>
  
  <!-- Coherence boundary labels -->
  <text x="170" y="240" font-size="11" fill="#9333ea" font-family="Arial, sans-serif">
    Coherence boundary
  </text>
  <text x="170" y="253" font-size="10" fill="#9333ea" font-family="Arial, sans-serif">
    (NLL degradation &lt; θ)
  </text>
  
  <text x="260" y="140" font-size="10" fill="#9333ea" font-family="Arial, sans-serif" opacity="0.6">
    Relaxed boundary
  </text>
  <text x="260" y="152" font-size="9" fill="#9333ea" font-family="Arial, sans-serif" opacity="0.6">
    (for hard direction)
  </text>
  
  <!-- Title -->
  <text x="300" y="30" font-size="16" fill="#333" font-family="Arial, sans-serif" font-weight="bold" text-anchor="middle">
    Loss Geometry in S-space
  </text>
  
  <!-- Key insight annotation -->
  <rect x="20" y="20" width="260" height="70" fill="#fff" stroke="#666" stroke-width="1" rx="5" opacity="0.9"/>
  <text x="30" y="40" font-size="11" fill="#333" font-family="Arial, sans-serif" font-weight="bold">
    Key insight:
  </text>
  <text x="30" y="55" font-size="10" fill="#333" font-family="Arial, sans-serif">
    Same V rotation + S scaling → reversible
  </text>
  <text x="30" y="68" font-size="10" fill="#333" font-family="Arial, sans-serif">
    via coefficient sign (c = ±1)
  </text>
  <text x="30" y="81" font-size="10" fill="#333" font-family="Arial, sans-serif">
    Adaptive coherence allows asymmetry
  </text>
  
  <!-- Legend -->
  <g transform="translate(400, 480)">
    <rect x="0" y="0" width="180" height="95" fill="#fff" stroke="#999" stroke-width="1" rx="3" opacity="0.95"/>
    <text x="10" y="18" font-size="11" fill="#333" font-family="Arial, sans-serif" font-weight="bold">Legend</text>
    
    <line x1="10" y1="30" x2="35" y2="30" stroke="#2563eb" stroke-width="2.5"/>
    <text x="40" y="34" font-size="10" fill="#333" font-family="Arial, sans-serif">Reference</text>
    
    <line x1="10" y1="45" x2="35" y2="45" stroke="#ea580c" stroke-width="2"/>
    <text x="40" y="49" font-size="10" fill="#333" font-family="Arial, sans-serif">Initial (t=0)</text>
    
    <line x1="10" y1="60" x2="35" y2="60" stroke="#16a34a" stroke-width="2.5"/>
    <text x="40" y="64" font-size="10" fill="#333" font-family="Arial, sans-serif">After c=+1</text>
    
    <line x1="10" y1="75" x2="35" y2="75" stroke="#dc2626" stroke-width="2.5"/>
    <text x="40" y="79" font-size="10" fill="#333" font-family="Arial, sans-serif">After c=-1</text>
  </g>
  
</svg>
